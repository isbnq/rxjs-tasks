import{A as $,B as v,C as l,D as n,E as s,F as a,I,K as N,L,M as Q,N as o,O as V,P as q,Q as g,R as U,S as w,T as R,U as D,W as z,X as G,c as b,ca as O,f as m,h as k,k as M,m as j,o as S,q as P,t as h,u as C,v as T,w as E,x as y,y as _,z as c}from"./chunk-A54WQI45.js";var F=class{constructor(){this.users=new Map,this.lastUserId=0,this.freeIds=[]}addUser(u){let p=this.freeIds.pop()??++this.lastUserId;return this.users.set(p,u),p}delUser(u){this.users.delete(u)&&this.freeIds.push(u)}getUserData(u){return this.users.get(u)}get usersEntries(){return this.users.entries()}};var B=(()=>{let u=class u extends F{constructor(){super(...arguments),this.usersActivityList=[],this.usersActivity$=new b(this.usersActivityList)}ngOnDestroy(){[...this.usersEntries].map(([i,{subscription:t}])=>t?.unsubscribe())}addUser(){let i=new b(!1),t=super.addUser({activity$:i});return this.usersActivityList.push({id:t,activity$:i}),this.usersActivity$.next(this.usersActivityList),t}delUser(i){super.delUser(i),this.usersActivityList=[...this.usersEntries].map(([t,{activity$:r}])=>({id:t,activity$:r})),this.usersActivity$.next(this.usersActivityList)}setUserActivity(i,t){let r=this.getUserData(i);r&&(t=t.pipe(P()),r.subscription?.unsubscribe(),r.subscription=M(t.pipe(m(()=>!0)),t.pipe(j(5e3),m(()=>!1))).pipe(S()).subscribe(r.activity$))}getUsersActivity(){return this.usersActivity$}};u.\u0275fac=(()=>{let i;return function(r){return(i||(i=_(u)))(r||u)}})(),u.\u0275prov=h({token:u,factory:u.\u0275fac,providedIn:"root"});let e=u;return e})();var x=(()=>{let u=class u{constructor(i){this.server=i,this.userId=this.server.addUser()}getUserId(){return this.userId}ngOnDestroy(){this.server.delUser(this.userId)}setActivity(i){this.server.setUserActivity(this.userId,i)}getUsersActivity(){return this.server.getUsersActivity().pipe(m(i=>i.filter(t=>t.id!==this.userId)))}};u.\u0275fac=function(t){return new(t||u)(T(B))},u.\u0275prov=h({token:u,factory:u.\u0275fac,providedIn:"root"});let e=u;return e})();var Y=["chattextinput"];function Z(e,u){if(e&1&&(n(0,"li",6),U(1,"async"),o(2),s()),e&2){let p=u.$implicit;l("ngClass",w(1,2,p.activity$)?"active":"inactive"),c(2),q(" User-",p.id," ")}}var H=(()=>{let u=class u{constructor(i){this.usersChat=i}ngOnInit(){this.username=`User-${this.usersChat.getUserId()}`,this.usersActivity$=this.usersChat.getUsersActivity()}ngAfterViewInit(){this.usersChat.setActivity(k(this.chattextinput.nativeElement,"input"))}ngOnDestroy(){}};u.\u0275fac=function(t){return new(t||u)($(x))},u.\u0275cmp=E({type:u,selectors:[["app-users-chat"]],viewQuery:function(t,r){if(t&1&&N(Y,5),t&2){let f;L(f=Q())&&(r.chattextinput=f.first)}},features:[g([x])],decls:8,vars:4,consts:[["chattextinput",""],[1,"container"],[1,"username"],[1,"users"],["class","user-activity",3,"ngClass",4,"ngFor","ngForOf"],[1,"chat-textinput"],[1,"user-activity",3,"ngClass"]],template:function(t,r){t&1&&(n(0,"div",1)(1,"div",2),o(2),s(),n(3,"ul",3),v(4,Z,3,4,"li",4),U(5,"async"),s(),a(6,"textarea",5,0),s()),t&2&&(c(2),V(r.username),c(2),l("ngForOf",w(5,2,r.usersActivity$)))},dependencies:[R,D,z],styles:[".container[_ngcontent-%COMP%]{min-width:300px;display:flex;flex-flow:column wrap;justify-content:center;align-items:center;gap:1rem;padding:1rem .5rem;background-color:#f5f5f5;border-radius:1rem}.username[_ngcontent-%COMP%]{text-align:center}.users[_ngcontent-%COMP%]{list-style-type:none;margin-block-start:0;margin-block-end:0;margin-inline-start:0px;margin-inline-end:0px;padding-inline-start:0;display:flex;flex-flow:row wrap;justify-content:center;align-items:center;gap:.5em;max-width:300px}.user-activity[_ngcontent-%COMP%]{color:#fff;padding:.16em .33em;border-radius:1rem}.user-activity.active[_ngcontent-%COMP%]{background-color:#00800080}.user-activity.inactive[_ngcontent-%COMP%]{background-color:#80808080}.chat-textinput[_ngcontent-%COMP%]{width:95%}"]});let e=u;return e})();function t4(e,u){e&1&&a(0,"app-users-chat")}var A=(()=>{let u=class u{constructor(){this.chatsCount=0}addChat(){this.chatsCount+=1}delChat(){this.chatsCount&&(this.chatsCount-=1)}getChatsCount(){return new Array(this.chatsCount)}};u.\u0275fac=function(t){return new(t||u)},u.\u0275cmp=E({type:u,selectors:[["app-task-5"]],features:[g([B])],decls:16,vars:1,consts:[[3,"click"],[1,"users-chats"],[4,"ngFor","ngForOf"]],template:function(t,r){t&1&&(n(0,"h2"),o(1,"\u041C\u043E\u043D\u0438\u0442\u043E\u0440\u0438\u043D\u0433 \u0430\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u0438 \u0432 \u0447\u0430\u0442\u0435"),s(),n(2,"p"),o(3,"\u0412\u0430\u043C \u043F\u0440\u0435\u0434\u0441\u0442\u043E\u0438\u0442 \u0440\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0430\u0442\u044C \u043C\u0435\u0445\u0430\u043D\u0438\u0437\u043C \u043C\u043E\u043D\u0438\u0442\u043E\u0440\u0438\u043D\u0433\u0430 \u0430\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u0438 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439 \u0432 \u0447\u0430\u0442\u0435. \u0426\u0435\u043B\u044C - \u0432\u044B\u0432\u043E\u0434\u0438\u0442\u044C \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F \u043E \u0442\u043E\u043C, \u043A\u043E\u0433\u0434\u0430 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0438 \u0430\u043A\u0442\u0438\u0432\u043D\u044B \u0438 \u043D\u0435\u0430\u043A\u0442\u0438\u0432\u043D\u044B."),a(4,"br"),o(5,`\u0412\u044B \u0434\u043E\u043B\u0436\u043D\u044B \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u0441\u0438\u0441\u0442\u0435\u043C\u0443, \u043A\u043E\u0442\u043E\u0440\u0430\u044F \u0431\u0443\u0434\u0435\u0442 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u0442\u044C \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439 \u0432 \u0447\u0430\u0442\u0435. \u041A\u043E\u0433\u0434\u0430 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C \u043D\u0430\u0447\u0438\u043D\u0430\u0435\u0442 \u043F\u0435\u0447\u0430\u0442\u0430\u0442\u044C \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435, \u0435\u0433\u043E \u0441\u0442\u0430\u0442\u0443\u0441 \u0434\u043E\u043B\u0436\u0435\u043D \u0438\u0437\u043C\u0435\u043D\u0438\u0442\u044C\u0441\u044F \u043D\u0430 "\u0430\u043A\u0442\u0438\u0432\u043D\u044B\u0439", \u0430 \u0435\u0441\u043B\u0438 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C \u043D\u0435 \u043F\u0440\u043E\u044F\u0432\u043B\u044F\u0435\u0442 \u0430\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u044C \u0432 \u0442\u0435\u0447\u0435\u043D\u0438\u0435 5 \u043C\u0438\u043D\u0443\u0442, \u0435\u0433\u043E \u0441\u0442\u0430\u0442\u0443\u0441 \u0434\u043E\u043B\u0436\u0435\u043D \u0438\u0437\u043C\u0435\u043D\u0438\u0442\u044C\u0441\u044F \u043D\u0430 "\u043D\u0435\u0430\u043A\u0442\u0438\u0432\u043D\u044B\u0439".
`),a(6,"br"),o(7,"\u0412\u0430\u043C \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u0438 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u044C \u043F\u043E\u0442\u043E\u043A\u0438 \u0434\u0430\u043D\u043D\u044B\u0445 \u0434\u043B\u044F \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u043D\u0438\u044F \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439 \u0438 \u0438\u0445 \u0430\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u0438. \u041F\u043E\u0441\u043B\u0435 \u044D\u0442\u043E\u0433\u043E \u0432\u044B \u0434\u043E\u043B\u0436\u043D\u044B \u043F\u0440\u0435\u043E\u0431\u0440\u0430\u0437\u043E\u0432\u0430\u0442\u044C \u044D\u0442\u0438 \u043F\u043E\u0442\u043E\u043A\u0438, \u0447\u0442\u043E\u0431\u044B \u043F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F \u043E \u0441\u0442\u0430\u0442\u0443\u0441\u0435 \u0430\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u0438 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439 \u0432 \u0443\u0434\u043E\u0431\u043D\u043E\u043C \u0444\u043E\u0440\u043C\u0430\u0442\u0435 \u0438 \u0432\u044B\u0432\u0435\u0441\u0442\u0438 \u044D\u0442\u0438 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F \u0432 \u043A\u043E\u043D\u0441\u043E\u043B\u044C."),s(),a(8,"hr"),n(9,"div")(10,"button",0),I("click",function(){return r.addChat()}),o(11,"Add chat"),s(),n(12,"button",0),I("click",function(){return r.delChat()}),o(13,"Delete chat"),s()(),n(14,"div",1),v(15,t4,1,0,"app-users-chat",2),s()),t&2&&(c(15),l("ngForOf",r.getChatsCount()))},dependencies:[D,H],styles:[".users-chats[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:center;align-items:center;gap:1rem}"]});let e=u;return e})();var e4=[{path:"",component:A}],J=(()=>{let u=class u{};u.\u0275fac=function(t){return new(t||u)},u.\u0275mod=y({type:u}),u.\u0275inj=C({imports:[O.forChild(e4),O]});let e=u;return e})();var v4=(()=>{let u=class u{};u.\u0275fac=function(t){return new(t||u)},u.\u0275mod=y({type:u,bootstrap:[A]}),u.\u0275inj=C({imports:[G,J]});let e=u;return e})();export{v4 as Task5Module};
